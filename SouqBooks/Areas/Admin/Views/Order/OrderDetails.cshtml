@using Models;
@using Utilities;
@model OrderHeader


	<br />
	<div class="container">
		<div class="card shadow border-0">

			<div class="card-header bg-secondary bg-gradient text-light ml-0 py-4">
				<div class="row px-4">
					<div class="col-6">
						<h5 class="pt-2 text-white">
							Shopping Cart
						</h5>
					</div>
					<div class="col-6 text-end">
						<a class="btn btn-outline-danger btn-sm">Back to Cart</a>
					</div>
				</div>
			</div>
			<div class="card-body">
				<div class="container rounded p-2">
					<div class="row">
						<div class="col-12 col-lg-6 pb-4">
							<div class="row">
								<h4 class="d-flex justify-content-between align-items-center mb-3">
									<span class="text-info">Shipping Details:</span>
								</h4>
							</div>
							<div class="row my-1">
								<div class="col-3">
									<label>Name</label>
								</div>
								<div class="col-9">
									<h6 class="" >@Model.Name</h6>
								</div>
							</div>
							<div class="row my-1">
								<div class="col-3">
									<label>PhoneNumber</label>
								</div>
								<div class="col-9">
									<h6 class="">@Model.PhoneNumber</h6>
								</div>
							</div>
							<div class="row my-1">
								<div class="col-3">
									<label>Address</label>
								</div>
								<div class="col-9">
									<h6 class="" >@Model.Address</h6>
								</div>
							</div>
							<div class="row my-1">
								<div class="col-3">
									<label>OrderDate</label>
								</div>
								<div class="col-9">
									<h6 class="">@Model.OrderDate.ToString("dddd, dd MMMM yyyy")</h6>
								</div>
							</div>
							<div class="row my-1">
								<div class="col-3">
									<label>OrderStatus</label>
								</div>
								<div class="col-9">
									<h6 class="">@Model.OrderStatus</h6>
								</div>
							</div>
							<div class="row my-1">
								<div class="col-3">
									<label>PaymentStatus</label>
								</div>
								<div class="col-9">
									<h6 class="">@Model.PaymentStatus</h6>
								</div>
							</div>
							@if (Model.PaymentStatus == "Approved")
							{
								<div class="row my-1">
								<div class="col-3">
									<label>PaymentDate</label>
								</div>
								<div class="col-9">
										<h6 class="">@Model.PaymentDate.ToString("dddd, dd MMMM yyyy")</h6>
								</div>
							</div>
							}
							<div class="row my-1">
								<div class="col-3">
									<label>SessionId</label>
								</div>
								<div class="col-9">
									<h6 class="">@Model.SessionId</h6>
								</div>
							</div>
							
						</div>

						<div class="col-12 col-lg-5 offset-lg-1">
							<h4 class="d-flex justify-content-between align-items-center mb-3">
								<span class="text-info">Order Summary:</span>
							</h4>
							<ul class="list-group mb-3">
								@foreach (var item in Model.orderDetails)
								{

									<li class="list-group-item d-flex justify-content-between">
										<div>
											<p class="my-0">@item.Product.Title</p>
											<small class="text-muted">category:@item.Product.category.Name</small><br>
											<small class="text-muted">Quantity: @item.Count</small>
										</div>
										<span class="text-muted">@item.Price.ToString("c", new System.Globalization.CultureInfo("en-US")) </span>

									</li>
								}

								<li class="list-group-item d-flex justify-content-between bg-light">
									<small class="text-info">Total (EGP)</small>
									<strong class="text-info">@Model.OrderTotal.ToString("c", new System.Globalization.CultureInfo("en-US")) </strong>
								</li>
							</ul>
							
							<form method="post" asp-action="UpdateOrderStatus">
							<input type="hidden" asp-for="Id" />
							@if (Model.OrderStatus == StaticDetails.StautsPending)
							{
									<button type="submit" name="status" value="@StaticDetails.StatusaProcessing" class="btn btn-success form-control">Start Processing</button>
							}
							@if (Model.OrderStatus == StaticDetails.StatusaProcessing)
							{
									<button type="submit" name="status" value="@StaticDetails.StatusShipped" class="btn btn-primary form-control">Shipp Order</button>
							}
							@if (Model.OrderStatus == StaticDetails.StatusShipped)
							{
									<button type="submit" name="status" value="@StaticDetails.StatusOutForDelivery" class="btn btn-warning form-control ">Out For Delivery</button>
							}
							@if (Model.OrderStatus != StaticDetails.StatusCanceled && Model.OrderStatus != StaticDetails.StatusCanceled)
							{
								<button type="submit" name="status" value="@StaticDetails.StatusCanceled" class="btn btn-danger form-control mt-3">Cancel Order</button>
							}
							else
							{
								<button type="button"  class="btn btn-outline-danger form-control mt-3">Cancelled Order</button>
							}	
						</form>
						</div>
					</div>
				</div>
			</div>
			<div class="card-footer">
				<div class="row">
					<div class="col-12 col-md-8 pt-2">
						<p>
							Estimate Arrival Date: @Model.OrderDate.ToShortDateString() - @Model.OrderDate.AddDays(10).ToShortDateString()
						</p>
					</div>
					<div class="col-12 col-md-4">
						<button type="submit" value="Place Order" class="btn btn-primary form-control">Update Order</button>
					</div>
				</div>
			</div>
		</div>
	</div>
